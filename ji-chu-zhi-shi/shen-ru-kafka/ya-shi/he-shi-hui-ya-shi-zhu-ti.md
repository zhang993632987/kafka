# 何时会压实主题

就像 delete 策略不会删除当前的活动片段一样，<mark style="color:blue;">**compact 策略也不会压实当前的活动片段**</mark>，**只有旧片段里的消息才会被压实。**

**在默认情况下，Kafka 会在主题中有 50% 的数据包含脏记录的情况下进行压实**。这样做的目的是避免压实太过频繁（因为压实会影响主题的读写性能），同时也能避免存在太多脏记录（因为它们会占用磁盘空间）。

管理员可以通过两个配置参数来控制压实时间：

* **min.compaction.lag.ms**：用于**确保消息被写入之后最短需要经过多长时间才可以被压实**。
* **max.compaction.lag.ms**：用于**确保消息从写入到可以被压实最长可以是多长时间**。当业务要求在一定时间内进行压实时可以使用这个参数，例如，GDPR 要求在收到删除请求之后 30 天内删除某些信息。
