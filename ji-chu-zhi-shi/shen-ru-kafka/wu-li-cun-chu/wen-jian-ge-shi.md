# 文件格式

<mark style="color:blue;">**每个日志片段被保存在一个单独的数据文件中**</mark>，文件中包含了**消息**和**偏移量**。<mark style="color:blue;">**保存在磁盘上的数据格式与生产者发送给服务器的消息格式以及服务器发送给消费者的消息格式是一样的**</mark><mark style="color:blue;">。</mark>因为磁盘存储和网络传输采用了相同的格式，所以 Kafka 可以使用**零复制技术**向消费者发送消息，并避免对生产者压缩过的消息进行解压和再压缩。

Kafka 消息由<mark style="color:blue;">**有效负载**</mark>和<mark style="color:blue;">**系统标头**</mark>组成。有效负载包括一个可选的键、值和一些可选的用户标头，其中每个标头也是一个键–值对。

**生产者是以批次的方式发送消息的**。如果每次只发送一条消息，那么使用批次反而会增加开销。但如果每次发送两条或更多的消息，那么使用批次就可以节约空间，减少网络带宽和磁盘的使用。**因为 Kafka 会为每个分区创建一个单独的批次，所以写入的分区越少，生产者的效率就越高。**

需要注意的是，**生产者可以在同一个生产请求中包含多个批次**。如果生产者端使用了压缩（推荐这么做），那么更大的批次将意味着不管是通过网络传输还是磁盘保存都能获得更好的压缩比。
