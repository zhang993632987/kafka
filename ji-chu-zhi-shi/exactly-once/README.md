# 精确一次性语义

Kafka 的精确一次性语义由两个关键特性组成：

* <mark style="color:blue;">**幂等生产者（避免因重试导致的消息重复）**</mark>
* <mark style="color:blue;">**事务语义（保证流式处理应用程序中的精确一次性处理）**</mark>

{% hint style="warning" %}
要想本章讨论的精确一次性语义有意义，那么必须先满足**至少一次性**语义。当满足了至少一次性语义之后，通过避免消息重复，进而获得精确一次性的保证。

所以，kafka 集群首先需要保证：

* **禁用不完全的首领选举**
* **最少同步副本数大于等于二**

然后，需要保证生产者正确设置了：

* **acks = all**
* **只要是可重试错误，直到导致问题的原因得到修复，必须一直重试**
{% endhint %}
