# 幂等生产者

> **典型场景**
>
> 1. 分区首领收到生产者发送的一条消息，这条消息被跟随者成功复制；
> 2. 然后，首领所在的 broker 在向生产者发送响应之前崩溃了；
> 3. 生产者没有收到回应，在一段时间之后将重新发送消息；
> 4. 消息被发送给了新首领，而新首领已经有了上一次写入的消息副本，结果导致消息重复。

<mark style="color:blue;">**Kafka 的幂等生产者可以自动检测并解决消息重复问题。**</mark>
