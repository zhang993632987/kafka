# 消息和批次

## 消息

Kafka的数据单元被称为<mark style="color:blue;">**消息**</mark>。

* **消息由**<mark style="color:blue;">**字节数组**</mark>**组成**，对Kafka来说，消息里的数据没有特殊的格式或含义。
*   **消息可以有一个可选的元数据——**<mark style="color:blue;">**键**</mark>**，键也是一个字节数组**，与消息一样，对Kafka来说没有特殊含义。**当需要以一种可控的方式将消息写入不同的**<mark style="color:blue;">**分区**</mark>**时，需要用到键**。

    最简单的例子就是为键生成一个一致性哈希值，然后用哈希值对主题分区数进行取模，为消息选取分区，这样可以保证具有相同键的消息总是会被写到相同的分区中（前提是分区数量没有发生变化）。

## 批次

<mark style="color:blue;">**为了提高效率，消息会被分成批次写入Kafka。批次包含了一组属于同一个主题和分区的消息**</mark>。

如果每一条消息都单独穿行于网络中，那么就会导致大量的网络开销，把消息分成批次传输可以减少网络开销。不过，这<mark style="color:orange;">**需要在时间延迟和吞吐量之间做出权衡：批次越大，单位时间内处理的消息就越多，对单条消息来说，其传输时间就越长。**</mark>

**消息批次会被压缩**，这样可以提升数据的传输和存储性能，但需要做更多的计算处理。
