# 3.3 消息的发送方式

## 1. 发送并忘记

把消息发送给服务器，但并不关心它是否成功送达。

大多数情况下，消息可以成功送达，因为Kafka是高可用的，而且生产者有自动尝试重发的机制。但是，**如果发生了不可重试的错误或超时，那么消息将会丢失，应用程序将不会收到任何信息或异常。**

## 2. 同步发送

调用send()方法发送消息，它会返回一个Future对象。可以调用get()方法等待Future完成，这样就可以在发送下一条消息之前知道当前消息是否发送成功。

## 3. 异步发送

调用send()方法，并指定一个**回调函数**，当服务器返回响应时，这个函数会被触发。

{% hint style="warning" %}
<mark style="color:blue;">**回调的执行将在生产者主线程中进行**</mark>，如果有两条消息被发送给同一个分区，则这可以保证它们的回调是按照发送的顺序执行的。<mark style="color:red;">**这就要求回调的执行要快，避免生产者出现延迟或影响其他消息的发送。不建议在回调中执行阻塞操作，阻塞操作应该被放在其他线程中执行。**</mark>
{% endhint %}
